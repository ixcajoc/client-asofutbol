<!-- <div class="container">
    <app-banner [title]="`Reporte Disciplinario`"></app-banner>
    <app-export-button [tableData]="disciplineList" ></app-export-button>
</div> -->


<!-- <div class="min-h-screen bg-gray-50 dark:bg-neutral-900 py-8"> -->
<div class="min-h-screen dark:bg-neutral-900 py-8">
  <div class="container mx-auto px-4">
    
    <!-- Header -->
    <div class="mb-6">
      <app-banner [title]="'Reporte Disciplinario'"></app-banner>
      <div class="mt-4 flex items-center justify-between flex-wrap gap-4">
        <div class="flex items-center gap-4 text-sm">
          <div class="flex items-center gap-2">
            <div class="w-4 h-6 bg-yellow-400 rounded-sm shadow-md"></div>
            <span class="text-gray-600 dark:text-gray-400">{{ getTotalYellowCards() }} Amarillas</span>
          </div>
          <div class="flex items-center gap-2">
            <div class="w-4 h-6 bg-red-600 rounded-sm shadow-md"></div>
            <span class="text-gray-600 dark:text-gray-400">{{ getTotalRedCards() }} Rojas</span>
          </div>
        </div>
        <app-export-button [tableData]="disciplineList"></app-export-button>
      </div>
    </div>

    <!-- Tabla Desktop -->
    <div class="hidden lg:block bg-white dark:bg-neutral-800 rounded-2xl shadow-xl overflow-hidden border border-gray-200 dark:border-neutral-700">
      
      <!-- Header de la tabla -->
      <div class="bg-gradient-to-r from-yellow-500 via-orange-500 to-red-600 px-6 py-4">
        <h2 class="text-xl font-bold text-white flex items-center gap-2">
          <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M3 6a3 3 0 013-3h10a1 1 0 01.8 1.6L14.25 8l2.55 3.4A1 1 0 0116 13H6a1 1 0 00-1 1v3a1 1 0 11-2 0V6z" clip-rule="evenodd"></path>
          </svg>
          Clasificación Disciplinaria
        </h2>
        <p class="text-yellow-100 text-sm mt-1">Jugadores con más tarjetas en la temporada</p>
      </div>

      <div class="overflow-x-auto">
        <table class="min-w-full">
          <thead class="bg-gray-50 dark:bg-neutral-900 border-b-2 border-gray-200 dark:border-neutral-700">
            <tr>
              <th scope="col" class="px-4 py-3 text-left">
                <span class="text-xs font-bold text-gray-600 dark:text-neutral-400 uppercase tracking-wider">#</span>
              </th>
              <th scope="col" class="px-6 py-3 text-left">
                <span class="text-xs font-bold text-gray-600 dark:text-neutral-400 uppercase tracking-wider">Jugador</span>
              </th>
              <th scope="col" class="px-4 py-3 text-left">
                <span class="text-xs font-bold text-gray-600 dark:text-neutral-400 uppercase tracking-wider">Equipo</span>
              </th>
              <th scope="col" class="px-3 py-3 text-center" title="Partidos Jugados">
                <span class="text-xs font-bold text-gray-600 dark:text-neutral-400 uppercase">PJ</span>
              </th>
              <th scope="col" class="px-4 py-3 text-center">
                <div class="flex items-center justify-center gap-1">
                  <div class="w-3 h-4 bg-yellow-400 rounded-sm"></div>
                  <span class="text-xs font-bold text-gray-600 dark:text-neutral-400 uppercase">Amarillas</span>
                </div>
              </th>
              <th scope="col" class="px-4 py-3 text-center">
                <div class="flex items-center justify-center gap-1">
                  <div class="w-3 h-4 bg-red-600 rounded-sm"></div>
                  <span class="text-xs font-bold text-gray-600 dark:text-neutral-400 uppercase">Rojas</span>
                </div>
              </th>
              <th scope="col" class="px-4 py-3 text-center">
                <span class="text-xs font-bold text-gray-600 dark:text-neutral-400 uppercase">Total</span>
              </th>
              <th scope="col" class="px-4 py-3 text-center">
                <span class="text-xs font-bold text-gray-600 dark:text-neutral-400 uppercase">Promedio</span>
              </th>
            </tr>
          </thead>
          <tbody class="divide-y divide-gray-200 dark:divide-neutral-700">
            @for (player of disciplineList; track $index) {
              <tr 
                class="group hover:bg-orange-50 dark:hover:bg-neutral-700/50 transition-colors"
                [ngClass]="getDisciplineRowClass(player.total_tarjetas)"
              >
                <!-- Ranking -->
                <td class="px-4 py-4">
                  <div class="flex items-center gap-2">
                    @if ($index < 3) {
                      <span 
                        class="flex items-center justify-center w-6 h-6 rounded-full text-xs font-bold text-white"
                        [ngClass]="{
                          'bg-yellow-500': $index === 0,
                          'bg-gray-400': $index === 1,
                          'bg-orange-600': $index === 2
                        }"
                      >
                        {{ $index + 1 }}
                      </span>
                    } @else {
                      <span class="text-sm font-semibold text-gray-600 dark:text-gray-400 ml-1">
                        {{ $index + 1 }}
                      </span>
                    }
                  </div>
                </td>

                <!-- Jugador con avatar y posición -->
                <td class="px-6 py-4">
                  <div class="flex items-center gap-3">
                    <div class="relative">
                      <div 
                        class="w-10 h-10 rounded-full flex items-center justify-center text-white text-xs font-bold flex-shrink-0"
                        [ngClass]="getPositionGradient(player.posicion)"
                      >
                        {{ player.numero_camiseta }}
                      </div>
                      <!-- Badge de posición -->
                      <div 
                        class="absolute -bottom-1 -right-1 w-5 h-5 rounded-full border-2 border-white dark:border-neutral-800 flex items-center justify-center text-[8px] font-bold"
                        [ngClass]="getPositionBadgeColor(player.posicion)"
                        [title]="player.posicion"
                      >
                        {{ getPositionAbbr(player.posicion) }}
                      </div>
                    </div>
                    <div class="min-w-0">
                      <p class="text-sm font-semibold text-gray-900 dark:text-white truncate">
                        {{ player.nombre }} {{ player.apellido }}
                      </p>
                      <p class="text-xs text-gray-500 dark:text-gray-400">
                        {{ player.posicion }}
                      </p>
                    </div>
                  </div>
                </td>

                <!-- Equipo -->
                <td class="px-4 py-4">
                  <span class="text-sm text-gray-700 dark:text-neutral-300 font-medium truncate max-w-[150px] inline-block" [title]="player.equipo">
                    {{ player.equipo }}
                  </span>
                </td>

                <!-- Partidos jugados -->
                <td class="px-3 py-4 text-center text-sm text-gray-700 dark:text-neutral-300 font-medium">
                  {{ player.partidos_jugados }}
                </td>

                <!-- Tarjetas amarillas -->
                <td class="px-4 py-4">
                  <div class="flex items-center justify-center gap-1">
                    @for (card of getCardArray(player.tarjetas_amarillas); track $index) {
                      <div class="w-2.5 h-3.5 bg-yellow-400 rounded-sm shadow-sm"></div>
                    }
                    <span class="ml-1 text-sm font-bold text-gray-900 dark:text-white">
                      {{ player.tarjetas_amarillas }}
                    </span>
                  </div>
                </td>

                <!-- Tarjetas rojas -->
                <td class="px-4 py-4">
                  <div class="flex items-center justify-center gap-1">
                    @for (card of getCardArray(player.tarjetas_rojas); track $index) {
                      <div class="w-2.5 h-3.5 bg-red-600 rounded-sm shadow-sm"></div>
                    }
                    <span class="ml-1 text-sm font-bold text-gray-900 dark:text-white">
                      {{ player.tarjetas_rojas }}
                    </span>
                  </div>
                </td>

                <!-- Total tarjetas -->
                <td class="px-4 py-4 text-center">
                  <span 
                    class="inline-flex items-center justify-center px-3 py-1 rounded-full text-sm font-bold"
                    [ngClass]="getTotalBadgeClass(player.total_tarjetas)"
                  >
                    {{ player.total_tarjetas }}
                  </span>
                </td>

                <!-- Promedio por partido -->
                <td class="px-4 py-4 text-center">
                  <span class="text-sm font-semibold text-gray-700 dark:text-neutral-300">
                    {{ getCardAverage(player.total_tarjetas, player.partidos_jugados) }}
                  </span>
                </td>
              </tr>
            }
          </tbody>
        </table>
      </div>

      <!-- Footer con estadísticas -->
      <div class="bg-gray-50 dark:bg-neutral-900 px-6 py-4 border-t border-gray-200 dark:border-neutral-700">
        <div class="flex flex-wrap items-center justify-between gap-4 text-sm">
          <div class="text-gray-600 dark:text-neutral-400">
            Total de jugadores: <span class="font-semibold text-gray-900 dark:text-white">{{ disciplineList.length }}</span>
          </div>
          <div class="flex items-center gap-4">
            <div class="text-gray-600 dark:text-neutral-400">
              Promedio de tarjetas: <span class="font-semibold text-gray-900 dark:text-white">{{ getAverageCards() }}</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Vista Mobile: Cards -->
    <div class="lg:hidden space-y-3">
      @for (player of disciplineList; track $index) {
        <div 
          class="bg-white dark:bg-neutral-800 rounded-xl shadow-md overflow-hidden transition-all hover:shadow-lg"
          [ngClass]="getDisciplineBorderClass(player.total_tarjetas)"
        >
          <!-- Header del card -->
          <div class="flex items-center justify-between p-4 bg-gradient-to-r from-gray-50 to-orange-50 dark:from-neutral-900 dark:to-neutral-800">
            <div class="flex items-center gap-3">
              <!-- Ranking badge -->
              @if ($index < 3) {
                <span 
                  class="flex items-center justify-center w-8 h-8 rounded-full text-sm font-bold text-white"
                  [ngClass]="{
                    'bg-yellow-500': $index === 0,
                    'bg-gray-400': $index === 1,
                    'bg-orange-600': $index === 2
                  }"
                >
                  {{ $index + 1 }}
                </span>
              } @else {
                <span class="flex items-center justify-center w-8 h-8 rounded-full bg-gray-200 dark:bg-neutral-700 text-sm font-bold text-gray-700 dark:text-gray-300">
                  {{ $index + 1 }}
                </span>
              }

              <!-- Avatar con dorsal -->
              <div class="relative">
                <div 
                  class="w-12 h-12 rounded-full flex items-center justify-center text-white text-sm font-bold"
                  [ngClass]="getPositionGradient(player.posicion)"
                >
                  {{ player.numero_camiseta }}
                </div>
                <div 
                  class="absolute -bottom-1 -right-1 w-6 h-6 rounded-full border-2 border-white dark:border-neutral-800 flex items-center justify-center text-[9px] font-bold"
                  [ngClass]="getPositionBadgeColor(player.posicion)"
                >
                  {{ getPositionAbbr(player.posicion) }}
                </div>
              </div>

              <!-- Nombre y equipo -->
              <div>
                <h3 class="text-sm font-bold text-gray-900 dark:text-white">
                  {{ player.nombre }} {{ player.apellido }}
                </h3>
                <p class="text-xs text-gray-500 dark:text-gray-400">
                  {{ player.equipo }}
                </p>
              </div>
            </div>

            <!-- Total tarjetas -->
            <div class="text-right">
              <div 
                class="text-2xl font-bold"
                [ngClass]="{
                  'text-red-600': player.total_tarjetas >= 5,
                  'text-orange-600': player.total_tarjetas >= 3 && player.total_tarjetas < 5,
                  'text-yellow-600': player.total_tarjetas < 3
                }"
              >
                {{ player.total_tarjetas }}
              </div>
              <div class="text-xs text-gray-500 dark:text-gray-400">tarjetas</div>
            </div>
          </div>

          <!-- Stats grid -->
          <div class="p-4">
            <div class="grid grid-cols-3 gap-3 mb-3">
              <div class="text-center">
                <div class="text-xs text-gray-500 dark:text-gray-400 mb-1">Partidos</div>
                <div class="text-lg font-bold text-gray-900 dark:text-white">
                  {{ player.partidos_jugados }}
                </div>
              </div>
              <div class="text-center">
                <div class="flex items-center justify-center gap-1 mb-1">
                  <div class="w-2 h-3 bg-yellow-400 rounded-sm"></div>
                  <span class="text-xs text-gray-500 dark:text-gray-400">Amarillas</span>
                </div>
                <div class="text-lg font-bold text-yellow-600">
                  {{ player.tarjetas_amarillas }}
                </div>
              </div>
              <div class="text-center">
                <div class="flex items-center justify-center gap-1 mb-1">
                  <div class="w-2 h-3 bg-red-600 rounded-sm"></div>
                  <span class="text-xs text-gray-500 dark:text-gray-400">Rojas</span>
                </div>
                <div class="text-lg font-bold text-red-600">
                  {{ player.tarjetas_rojas }}
                </div>
              </div>
            </div>

            <!-- Promedio -->
            <div class="pt-3 border-t border-gray-200 dark:border-neutral-700">
              <div class="flex items-center justify-between text-xs">
                <span class="text-gray-600 dark:text-gray-400">Promedio por partido</span>
                <span class="font-semibold text-gray-900 dark:text-white">
                  {{ getCardAverage(player.total_tarjetas, player.partidos_jugados) }}
                </span>
              </div>
            </div>
          </div>
        </div>
      }
    </div>

    <!-- Empty state -->
    @if (disciplineList.length === 0) {
      <div class="bg-white dark:bg-neutral-800 rounded-2xl shadow-xl p-12 text-center">
        <svg class="mx-auto h-16 w-16 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
        </svg>
        <h3 class="mt-4 text-lg font-medium text-gray-900 dark:text-white">No hay datos disciplinarios</h3>
        <p class="mt-2 text-sm text-gray-500 dark:text-gray-400">Los datos se actualizarán cuando haya tarjetas registradas.</p>
      </div>
    }

  </div>
</div>